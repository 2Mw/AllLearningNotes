# æ·±åº¦å­¦ä¹ æ¡†æ¶ä½¿ç”¨æŠ€å·§

## Pandas

ğŸ”µ`read_csv()`

è¯»å–csvæ–‡ä»¶ï¼Œé»˜è®¤å‚æ•°`header=0`ï¼Œè¯»å–è¡¨æ ¼ç¬¬ä¸€è¡Œä¸ºè¡¨å¤´ã€‚ 

ğŸ”µ`iloc[]`å’Œ`loc[]`

`iloc[]`æ˜¯æ ¹æ®ç´¢å¼•æ¥å¯¹æ•°æ®è¿›è¡Œè·å–ï¼Œ`loc[]`æ˜¯æ ¹æ®åˆ—åæ¥å¯¹æ•°æ®è¿›è¡Œè·å–ã€‚

ğŸ”µå¡«å……`NAN`å€¼

```python
inputs, outputs = data.iloc[:, 0:2], data.iloc[:, 2]
inputs = inputs.fillna(inputs.mean())
```

ğŸ”µ`apply()`å‡½æ•°

å‚è€ƒï¼š[pandas.DataFrame.apply](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html)

å¯¹æ•°æ®çš„æ¯ä¸€è¡Œæˆ–è€…æ¯ä¸€åˆ—ä½¿ç”¨å¯¹åº”çš„å‡½æ•°ï¼Œå¦‚ä¸‹è¿™ä¸ªä¾‹å­æ˜¯å¯¹æ¯ä¸€åˆ—éƒ½è¿›è¡Œå½’ä¸€åŒ–ã€‚

```python
a=pd.DataFrame([[1,2], [3,4]])
a.apply(lambda x:(x-x.mean)/x.std())
```

ğŸ”µ`get_dummies()`å‡½æ•°

å°†åˆ†ç±»çš„æ•°æ®ä¸­è½¬ä¸ºåˆ—ï¼Œç›¸å½“äºå°†åˆ†ç±»çš„æ•°æ®è½¬ä¸ºç‹¬çƒ­ç¼–ç ã€‚

```python
s = pd.Series(list('abca'))
pd.get_dummies(s)
```

è¾“å‡ºï¼š

```
  a  b  c
0  1  0  0
1  0  1  0
2  0  0  1
3  1  0  0
```

ğŸ”µæ•°ç»„æ’åº

`argsort()`æ˜¯ç”¨æ¥å¾—åˆ°æ’åºå¥½çš„åŸæ¥æ•°ç»„index

åœ¨ä¸€ç»´æƒ…å†µä¸‹ï¼Œä½¿ç”¨`a[a.argsort()]`å°±å¾—åˆ°äº†æ’åºå¥½çš„æ•°ç»„ã€‚

```python
a=np.array([4,3,1,2])
a=a[a.argsort()]
```

## Numpy

ğŸ”µå¹¿æ’­

å¹¿æ’­å¯¹ä¸åŒå½¢çŠ¶(shape)çš„æ•°ç»„è¿›è¡Œæ•°å€¼è®¡ç®—çš„æ–¹å¼ï¼Œ å¯¹æ•°ç»„çš„ç®—æœ¯è¿ç®—é€šå¸¸åœ¨ç›¸åº”çš„å…ƒç´ ä¸Šè¿›è¡Œã€‚

* ä¸¤ä¸ªçŸ©é˜µå½¢çŠ¶ç›¸åŒï¼Œå°±æ˜¯å¯¹åº”ä½ç½®çš„ç›¸ä¹˜

  ```python
  a = np.array([1,2,3,4]) 
  b = np.array([10,20,30,40]) 
  print (a*b) // [10,40,90,160]
  ```

* ä¸¤çŸ©é˜µå½¢çŠ¶ä¸åŒ

  åŠ å…¥açš„shapeä¸º`(s1,s2,s3,s4...,sn)`,bä¸ä¸ºæ ‡é‡ä¸”å…¶shapeä¸º`(x1,x2,x3)`ï¼Œbçš„ç»´åº¦å°äºaä¸”æœ‰$x_1=s_{n-2},x_2=s_{n-1},x_3=s_{n}$ä¹‹ç±»ï¼Œåˆ™å¯ä»¥è¿›è¡Œå¹¿æ’­ã€‚

ğŸ”µèŠ‚çº¦å†…å­˜

```python
Y = Y + X		# (X)
Y[:] = Y + X	# (âˆš)
```

## PyTorch

ğŸ”µæ•°æ®é›†å¤„ç†ï¼š

`torch.utils.data.Dataset`

Datasetåˆ†ä¸ºä¸¤ç§ï¼š1. map-style dataset 2. iterable-style dataset

å¸¸ç”¨çš„æ˜¯map-style dataset

æ˜ å°„å½¢å¼çš„æ•°æ®é›†çš„ç±»éœ€è¦å®ç°`__getitem__()` å’Œ `__len__()`æ–¹æ³•æ¥é€šè¿‡indexè¿›è¡Œæ•°æ®è®¿é—®å’ŒæŸ¥çœ‹æ•°æ®é›†çš„é•¿åº¦ã€‚

For example, such a dataset, when accessed with dataset[idx], could read the idx-th image and its corresponding label from a folder on the disk.

æ¨¡æ¿ï¼š

```python
class ImgDataset(dataset.Dataset):  # ç»§æ‰¿çˆ¶ç±»dataset
    def __init__(self, x, y=None, transform=None):
        self.x = x
        self.y = y
        if y is not None:
            self.y = tc.LongTensor(y)  # y åº”è¯¥ä¸ºLong Tensor
        self.transform = transform

    def __len__(self):  # å®ç°å‡½æ•°__len__
        return len(self.x)

    def __getitem__(self, index):  # å®ç°å‡½æ•°__getitem__
        X = self.x[index]
        if self.transform is not None:
            X = self.transform(X)
        if self.y is not None:
            return X, self.y[index]
        else:
            return X
```

`torch.utils.data.DataLoader` æ˜¯pytorchæ•°æ®åŠ è½½ä¸­æœ€å®ç”¨çš„åŒ…ï¼Œèƒ½å¤Ÿä»¥è¿­ä»£çš„å½¢å¼åŠ è½½æ•°æ®é›†ã€‚

å…¶å¯ä»¥ï¼š

* æ˜ å°„ä»¥åŠè¿­ä»£çš„æ–¹å¼åŠ è½½æ•°æ®é›†ï¼ˆmap-style and iterable-styleï¼‰
* è‡ªå®šä¹‰æ•°æ®åŠ è½½æ–¹å¼
* è‡ªåŠ¨åˆ†æ‰¹ï¼ˆbatchï¼‰
* å•çº¿ç¨‹æˆ–è€…å¤šçº¿ç¨‹åŠ è½½æ•°æ®
* â€¦â€¦â€¦â€¦

ğŸ”µ`nn.Module`çš„ä½¿ç”¨ï¼š

ç”¨äºæ­å»ºç½‘ç»œæ¨¡å‹ï¼š

```python
class Classifier(nn.Module):    # ç»§æ‰¿çˆ¶ç±»nn.Module
    def __init__(self):
        super(Classifier, self).__init__()
        # torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)
        # torch.nn.MaxPool2d(kernel_size, stride, padding)
        # åŸå›¾è¾“å…¥ç»´åº¦ (128, 128, 3)
        self.cnn = nn.Sequential(
            # è¾“å…¥ä¸ºå½©è‰²å›¾ç‰‡ï¼Œè¾“å‡ºé€šé“64 ï¼Œ3X3çš„å·ç§¯æ ¸ï¼Œ1æ­¥é•¿ï¼Œ å¡«å……é•¿åº¦ä¸º1=>ä¸ºäº†å‡‘128ï¼Œä¸ç„¶126ä¸å®¹æ˜“è§£å†³
            nn.Conv2d(3, 64, 3, 1, 1),  # (128, 128, 64)
            nn.BatchNorm2d(64), # norm2dçš„è¾“å…¥ä¸ºç‰¹å¾æ•°é‡ï¼Œå¹¶è¿›è¡Œæ ‡å‡†åŒ–ï¼Œè¿™é‡Œå¯ä»¥è®¾ç½®momentumå’Œeps
            nn.ReLU(),  # è¿›è¡ŒReLUå‡½æ•°è½¬æ¢
            nn.MaxPool2d(2, 2, 0),  # (64, 64, 64)

            # ä¸Šä¸€ä¸ªconv + maxpoolçš„è¾“å‡ºä¸ºè¿™æ¬¡çš„è¾“å…¥
            """
            	...
           	 """

            nn.Conv2d(512, 512, 3, 1, 1),  # (8, 8, 512)
            nn.BatchNorm2d(512),
            nn.ReLU(),
            nn.MaxPool2d(2, 2, 0),  # (4, 4, 512)
        )

        self.fc = nn.Sequential(
            nn.Linear(512 * 4 * 4, 1024),
            nn.Dropout(0.5),
            nn.ReLU(),
            nn.Linear(1024, 512),
            nn.Dropout(0.5),
            nn.ReLU(),
            nn.Linear(512, 11)
        )

    def forward(self, x):
        out = self.cnn(x) # è¿›è¡ŒCNNè½¬æ¢
        out = out.view(out.size()[0], -1)   # æ€»æ„Ÿè§‰è¿™å¥è¯æ²¡ä»€ä¹ˆç”¨
        return self.fc(out) # è¾“å…¥ç½‘ç»œï¼Œæœ‰å››å±‚ç½‘ç»œï¼šè¾“å…¥å±‚ï¼Œéšè—å±‚1ï¼Œéšè—å±‚2ï¼Œè¾“å‡ºå±‚ã€‚æœ€åè¾“å‡º11ç»´åº¦çš„å‘é‡ï¼ˆæœ‰11ç§ç±»åˆ«çš„é£Ÿå“ï¼‰ã€‚
```

ğŸ”µéšæœºç§å­

å‚è€ƒï¼š

* [torch.backends.cudnn.benchmark](https://zhuanlan.zhihu.com/p/73711222)
* [torch.backends.cudnn.deterministic](https://zhuanlan.zhihu.com/p/141063432)

`torch.backends.cudnn.deterministic`å°†è¿™ä¸ª flag ç½®ä¸º`True`çš„è¯ï¼Œæ¯æ¬¡è¿”å›çš„å·ç§¯ç®—æ³•å°†æ˜¯ç¡®å®šçš„ï¼Œå³é»˜è®¤ç®—æ³•ã€‚å¦‚æœé…åˆä¸Šè®¾ç½® Torch çš„éšæœºç§å­ä¸ºå›ºå®šå€¼çš„è¯ï¼Œåº”è¯¥å¯ä»¥ä¿è¯æ¯æ¬¡è¿è¡Œç½‘ç»œçš„æ—¶å€™ç›¸åŒè¾“å…¥çš„è¾“å‡ºæ˜¯å›ºå®šçš„

```python
def same_seeds(seed):
    torch.manual_seed(seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed(seed)
        torch.cuda.manual_seed_all(seed)  # ä¸ºæ‰€æœ‰GPUéƒ½è¿›è¡Œç§å­éšæœº
    np.random.seed(seed)  
    torch.backends.cudnn.benchmark = False
    torch.backends.cudnn.deterministic = True
```

ğŸ”µä¿å­˜å’ŒåŠ è½½æ¨¡å‹

```python
torch.save(net.state_dict(), 'mlp.params')
clone = MLP()
clone.load_state_dict(torch.load('mlp.params'))
clone.eval()
```

ğŸ”µ`torch.Embedding(num_embeddings, embedding_dim)` è¯åµŒå…¥

`num_embeddings`è¡¨ç¤ºè¯æ±‡çš„æ•°é‡

`embedding_dim`è¡¨ç¤ºè¾“å‡ºè¯å‘é‡çš„ç»´åº¦ã€‚

## matplotlib



## seaborn



## Tensorflow

### åŸºç¡€ä½¿ç”¨

æ„å»ºå¸¸é‡å’Œå˜é‡ï¼ˆå¯ä»¥é€‚é…numpyï¼‰ï¼š

```python
a=tf.constant([[1,2],[3,4]])
print(a)
# å˜é‡ï¼Œtrainableè¡¨ç¤ºå¯ç”¨äºæ±‚å¯¼ï¼Œé»˜è®¤ä¸ºtrue
av = tf.Variable(a, name="a var", trainable=True)
print(av)
# åˆå§‹åŒ–10X10ï¼Œå…¨éƒ¨ä¸º1çš„tensorå¸¸é‡
a=tf.constant(1,dtype=tf.float32, shape=[10,10], name='good')
```

### name_scopeçš„ä½¿ç”¨

ä¼šä¸ºå½“å‰å±€éƒ¨ä»£ç æˆ–è€…å…¶ä»–å‘½åçš„å˜é‡æ·»åŠ å‰ç¼€ã€‚

```python
with tf.name_scope("demo"):
    a=tf.Variable([1,2], name='a')
    print(a)
a=tf.Variable([1,2], name='a')
print(a)
```

è¾“å‡ºï¼š

```
<tf.Variable 'demo/a:0' shape=(2,) dtype=int32, numpy=array([1, 2])>
<tf.Variable 'a:0' shape=(2,) dtype=int32, numpy=array([1, 2])>
```
