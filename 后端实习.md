# Go for intern

## 前言

推荐网站：

* 面经八股交流类网站
  1. [牛客网](https://www.nowcoder.com/)
  2. [CS-Notes](http://www.cyc2018.xyz/)：八股文的汇总
  3. [JavaGuide](https://javaguide.cn/)：不仅包含Java知识，还有其他
  4. [代码随想录](https://programmercarl.com/)：包含求职、面经、算法类的优秀总结
* 算法刷题类：
  1. [牛客网](https://www.nowcoder.com/)
  2. [力扣](https://leetcode-cn.com/problemset/algorithms/)
  3. [AcWing](https://www.acwing.com/)
* 推荐书籍：
  1. 深入理解Java虚拟机

## Redis

### redis为什么这么快

参考：[15张图解：Redis的快可不是吹吹的](https://mp.weixin.qq.com/s/0R0Evh1QX5BPOQt9233vpQ)

<img src="https://mmbiz.qpic.cn/mmbiz_png/g6hBZ0jzZb0Zb0XiaaR6bGaN80wicXIIP735YhoW1fic47MuJOx0HheBX4ficULcmdHhdGQnqGcfCgvunMmxpb8LnA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:50%;" />

1. redis是基于内存实现的数据库，数据就存储在内存当中，减少了与磁盘之间的IO操作，因此速度很快。
2. 底层使用了高效的数据结构：比如双端链表、压缩列表、哈希表以及跳跃表等，使得数据存储的效率更高。
3. redis是单线程的，就避免了多线程之间切换CPU的上下文切换的开销。
4. redis采用的是I/O 多路复用模型同时监听客户端连接

### 缓存穿透、缓存击穿、缓存雪崩

🔵缓存穿透

缓存和数据库中都不存在对应的数据被大量请求。由于缓存中数据不存在，所有数据请求会直接穿透在数据库上。

原因：可能存在恶意请求爬虫以及黑客攻击。

解决：将对应null值的key缓存到数据库；逻辑层对不合理的请求进行拦截；使用布隆过滤器。

🔵缓存击穿

大量请求同时查询缓存中**某个**key，而这个key恰好失效了，导致大量请求打在数据库层。

原因：单个key为高热数据，恰好key过期

解决：延长key的失效时间或者设置为永久key；高峰期来临的时候刷新key的有效期；设置多级缓存。

🔵缓存雪崩

在较短的时间内，**大规模**的key缓存失效或者缓存服务器宕机了，导致大量的请求打在数据库上。

问题：大规模的key失效或者缓存服务器宕机

解决：对于key失效时间加上随机值；采用限流手段牺牲部分用户的体验来降低服务器的压力；根据业务类别对不同的key采用不同的失效策略。

### Redis如何持久化及其基本原理

参考：

* [Redis 面试全攻略、面试题大集合-0x7](https://mp.weixin.qq.com/s/6NobACeeKCcUy98Ikanryg)
* [Redis | rdb-持久化](http://www.cyc2018.xyz/数据库/Redis.html#rdb-持久化)

redis持久化的两种方式：RDB和AOF

🔵RDB(redis database)是将redis数据库快照以二进制的方式保存到硬盘中。

* 适合大规模的数据恢复，对数据库的完整性要求不大
* 在进行持久化的过程中需要fork子进程，很占用CPU。

`save`和`bgsave`命令

* save命令是阻塞式持久化，执行命令的时候，redis将数据全部持久化完毕后，才能处理其他命令。
* bgsave是非阻塞持久化，是创建子进程将内存中的数据写入RDB文件，期间可以执行其他命令。

🔵AOF(append of file)是将所有的写命令和参数追加到AOF文件中。

appendfsync选项：

|   选项   |         同步频率         |
| :------: | :----------------------: |
|  always  |     每个写命令都同步     |
| everysec |       每秒同步一次       |
|    no    | 让操作系统来决定何时同步 |

- always 选项会严重减低服务器的性能；
- everysec 选项比较合适，可以保证系统崩溃时只会丢失一秒左右的数据，并且 Redis 每秒执行一次同步对服务器性能几乎没有任何影响；
- no 表示默认系统的缓存区写入磁盘的机制，不做程序强制，数据安全性和完整性差一些。

## MySQL

### 事务特性实现原理(ACID)

参考：[深入学习MySQL事务：ACID特性的实现原理](https://www.cnblogs.com/kismetv/p/10331633.html)

* 原子性(atomic)：即指事务是一个不可分割的单位，其中的操作要么全部执行，要么就都不执行。其实现是基于undolog(有了undo就能够回滚)。
* 一致性(Consistency)：数据库的完整性约束没有被破坏，事务执行前后都是合法的数据状态。其实现是**基于其他三个特性**。
* 隔离性(Isolation)：保证事务的执行尽量不受其他事务的影响。其实现是基于锁机制和MVCC。
* 持久性(Durable)：保证事务提交之后不会因为宕机等其他因素的影响而导致数据丢失。其实现主要是基于redolog。
