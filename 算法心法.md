# Algorithm

## å‰è¨€

### åˆ·é¢˜ç½‘ç«™ï¼š

* Leetcodeï¼š[Leetcode](https://leetcode-cn.com/problemset/algorithms/)
* acwingï¼š[acwing](https://www.acwing.com/)
* å‰‘æŒ‡Offerï¼š[å‰‘æŒ‡Offer link](https://leetcode-cn.com/problem-list/xb9nqhhg/)
* ç‰›å®¢ç½‘ï¼š[ç‰›å®¢ç½‘](https://www.nowcoder.com/exam/oj)

## ä¸€. æ•°ç»„ä¸é“¾è¡¨

### 1. æœ‰ç¯é“¾è¡¨

ğŸ”µå¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯ï¼š

<img src="ç®—æ³•å¿ƒæ³•.assets/168178e06e2b0f1729f77522d3440c4.jpg" alt="168178e06e2b0f1729f77522d3440c4" style="zoom: 40%;" />

é¾Ÿå…”èµ›è·‘ç®—æ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰ï¼š

åˆšå¼€å§‹æŒ‡é’ˆAå’ŒæŒ‡é’ˆBæŒ‡å‘é“¾è¡¨å¤´ï¼ŒAæ¯å‘å‰èµ°ä¸€æ­¥ï¼ŒBå°±å‘å‰èµ°ä¸¤æ­¥ã€‚

å¦‚æœæ— ç¯ï¼ŒBä¼šé¦–å…ˆå˜æˆnullç©ºæŒ‡é’ˆï¼ŒBæŒ‡é’ˆä¸å¯èƒ½è¿½ä¸ŠAã€‚

å½“Bè·ç¦»Aæœ‰1ä¸ªè·ç¦»æ—¶ï¼Œä¸‹ä¸€æ¬¡è¿­ä»£ä¸¤è€…ä¸€å®šä¼šç›¸é‡ã€‚

å½“Bè·ç¦»Aæœ‰2ä¸ªè·ç¦»çš„æ—¶å€™ï¼Œç»è¿‡ä¸€æ¬¡è¿­ä»£å°±ä¼šå˜æˆç¬¬ä¸€ç§æƒ…å†µï¼Œå› æ­¤ä¸€å®šä¼šç›¸é‡ã€‚

**ç»“è®º**ï¼šåªè¦ä¸¤è€…åœ¨ç¯ä¸­ï¼Œæœ€åéƒ½ä¸€å®šä¼šç›¸é‡ã€‚

ğŸ”µå¦‚ä½•ç¡®å®šæœ‰ç¯é“¾è¡¨çš„èµ·ç‚¹ï¼š

ç”±ä¸Šé¢ç»“è®ºå¯æ¨ï¼Œå½“å°†ç¯ä¸­çš„èµ·ç‚¹æ–­å¼€ä¸ºé“¾è¡¨çš„æ—¶å€™ï¼Œåœ¨é“¾è¡¨å‰åŠæ®µçš„æ—¶å€™Aä¸å¯èƒ½è¿½ä¸ŠBï¼Œåœ¨ååŠæ®µçš„æ—¶å€™æ ¹æ®åˆä¸­æ•°å­¦ä¹‹åå¯å¾—ä¸¤è€…æœ€ç»ˆåœ¨ç»ˆç‚¹æ‰èƒ½ç›¸é‡ï¼Œå› æ­¤å¯å¾—Aä¸Bæ¯æ¬¡ç›¸é‡çš„åœ°ç‚¹éƒ½ç›¸åŒã€‚

å½“ç¬¬ä¸€æ¬¡ç›¸é‡çš„æ—¶å€™å¼€å§‹è®°å½•ï¼Œç¬¬äºŒæ¬¡ç›¸é‡çš„æ—¶å€™è®°å½•Aèµ°è¿‡çš„è·ç¦»ä¸º $K$ ï¼Œå³å¾—ç¯çš„é•¿åº¦ $K$ã€‚

<img src="ç®—æ³•å¿ƒæ³•.assets/d5366ab77a944e857bcf091dca4685c.jpg" alt="d5366ab77a944e857bcf091dca4685c" style="zoom:50%;" />

ç”±äºç¯çš„é•¿åº¦ä¸º $K$ï¼Œè®¾é“¾è¡¨çš„é•¿åº¦ä¸º $m$ï¼Œå› æ­¤è®©Aå’ŒBåŒæ—¶å›åˆ°é“¾è¡¨èµ·ç‚¹ï¼Œå…ˆè®©Bèµ°Kæ­¥ï¼›ç„¶åAå’ŒBåŒæ—¶å‡ºå‘ï¼Œå½“BæŒ‡é’ˆä¸AæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå³å¯å¾—åˆ°ç¯å¤´ã€‚

### 2. åŒæŒ‡é’ˆ

é¢˜ç›®ï¼š

* [ä¸‰æ•°ä¹‹å’Œ](https://leetcode-cn.com/problems/3sum/)
* [æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ](https://leetcode-cn.com/problems/3sum-closest/)
* [æ—¥å¿—ç»Ÿè®¡](https://www.acwing.com/problem/content/1240/)
* [11. ç››æœ€å¤šæ°´çš„å®¹å™¨](https://leetcode.cn/problems/container-with-most-water/)

### 3. å‰ç¼€å’Œä¸å·®åˆ†æ•°ç»„

é¢˜ç›®ï¼š

* [å‰ç¼€å’Œ (æ¨¡æ¿)](https://www.acwing.com/problem/content/797/)
* [å­çŸ©é˜µçš„å’Œ (æ¨¡æ¿)](https://www.acwing.com/problem/content/798/)
* [å·®åˆ† (æ¨¡æ¿)](https://www.acwing.com/problem/content/799/)
* [å·®åˆ†çŸ©é˜µ (æ¨¡æ¿)](https://www.acwing.com/problem/content/800/)

ğŸ”µå‰ç¼€å’Œï¼š

æŸ¥è¯¢ä¸€ä¸ªæ•°ç»„ä¸­é—´æŸæ®µåºåˆ—çš„å’Œã€‚

æ¬²æ±‚$\displaystyle\sum_{i=l}^ra[i]$ï¼Œè®¾$S[j]=\displaystyle\sum_{i=0}^ja[i]$ï¼Œåˆ™$\displaystyle\sum_{i=l}^ra[i]=S[r]-S[l-1]$ã€‚

æ‰©å±•äºŒç»´çŸ©é˜µå’Œã€‚

<img src="ç®—æ³•å¿ƒæ³•.assets/c0fb61ece5e6adddf0932f33f547b22.jpg" alt="c0fb61ece5e6adddf0932f33f547b22" style="zoom:50%;" />

AåŒºåŸŸä¹‹å’Œ=$S[i][j]-s[a][j]-s[i][b]+s[a][b]$

ğŸ”µå·®åˆ†çŸ©é˜µ

å¯¹äºä¸€ä¸ªæ•°ç»„ï¼Œè¦å¯¹ä¸­é—´ $[l,r]$ éƒ½åŠ ä¸ŠæŸä¸ªå¸¸æ•°$c$ï¼Œç„¶åæ±‚æœ€ç»ˆçš„åºåˆ—ã€‚

æ€æƒ³ï¼šåˆ©ç”¨å‰ç¼€å’Œçš„é€†æ€æƒ³ã€‚å¯¹äºåŸæ•°ç»„$a[i]$ä¸­åŠ æŸä¸ªå¸¸æ•°$c$ï¼Œå…¶å¯¹åº”çš„å‰ç¼€å’Œæ•°ç»„$s[i:n]$éƒ½éœ€è¦åŠ ä¸ŠCã€‚å› æ­¤å¯ä»¥åˆ©ç”¨è¿™ç§é€†æ€æƒ³å°†å¯¹åº”çš„æ•°ç»„çœ‹æˆå‰ç¼€å’Œæ•°ç»„ï¼Œå‰ç¼€å’Œä¸­çš„åŸæ•°ç»„å³ä¸ºå·®åˆ†æ•°ç»„ã€‚

æ„é€ å·®åˆ†æ•°ç»„çš„å…¬å¼ï¼š$c[i]=a[i]-a[i-1]$ï¼Œè‹¥è¦å¯¹åŒºé—´ $[l,r]$ éƒ½è¦åŠ ä¸ŠæŸä¸ªå¸¸æ•°Cï¼Œåˆ™åªéœ€è¦ $c[l]+c$ï¼Œ$c[r+1]-c$å³å¯ï¼Œæœ€ç»ˆæ±‡æ€»æ•°ç»„ $c$ çš„å‰ç¼€å’Œæ•°ç»„å³å¯å¾—åˆ°æœ€ç»ˆçš„åºåˆ—ã€‚æ—¶é—´å¤æ‚åº¦ç”±åŸæ¥çš„ $O(n^2)$ å°†ä¸ºäº† $O(n)$ã€‚

### 4. é“¾è¡¨çš„æ•°ç»„è¡¨ç¤ºæ³•

é¢˜ç›®ï¼š

* [å•é“¾è¡¨](https://www.acwing.com/problem/content/828/)

ä¸€èˆ¬æƒ…å†µä¸‹å¯¹äºé“¾è¡¨çš„è¡¨ç¤ºæ–¹æ³•éƒ½æ˜¯ä½¿ç”¨ç»“æ„ä½“çš„å½¢å¼ï¼Œåˆ›å»ºçš„æ—¶å€™é‡‡ç”¨çš„æ˜¯newçš„æ–¹æ³•ã€‚ç„¶è€Œè¿™ç§æ–¹å¼å¯¹äºæ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µå°±å¯„äº†ï¼Œä¼šå¯¼è‡´TLEç­‰æƒ…å†µï¼Œå› æ­¤éœ€è¦æ›´åŠ å¿«é€Ÿçš„æ–¹æ³•æ¥åˆ›å»ºæ•°ç»„ã€‚

è¿™é‡Œé‡‡ç”¨æ•°ç»„çš„æ–¹å¼æ¥è¿›è¡Œè¡¨ç¤ºé“¾è¡¨ï¼Œç”¨ $e[n]$ å­˜å‚¨é“¾è¡¨ä¸­çš„ä¿¡æ¯ï¼Œ$en[n]$ è¡¨ç¤ºé“¾è¡¨ä¸­å¯¹åº”ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ç´¢å¼•ã€‚

## äºŒ. å †æ ˆé˜Ÿåˆ—

### 1. hint

å¯¹äºå †å’Œé˜Ÿåˆ—ä¸¤ç§æ•°æ®ç»“æ„ï¼Œå…¶æ“ä½œåªæ¶‰åŠåˆ°å¤´å’Œå°¾ï¼Œå› æ­¤å¯¹äºå·²ç»æœ‰å¤´å’Œå°¾æŒ‡é’ˆçš„æƒ…å†µä¸‹ï¼Œå°±æ— éœ€è¿›è¡Œå…¶ä»–å¤šä½™æ“ä½œã€‚

ä¾‹é¢˜ï¼š[å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—](https://leetcode-cn.com/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof/)

### 2. å•è°ƒæ ˆ

ä¾‹é¢˜ï¼š
* [42. æ¥é›¨æ°´](https://leetcode-cn.com/problems/trapping-rain-water/)
* [84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/)
* [316. å»é™¤é‡å¤å­—æ¯](https://leetcode-cn.com/problems/remove-duplicate-letters/)

å³ç»´æŒä¸€ä¸ªå•è°ƒé€’å¢æˆ–è€…é€’å‡çš„æ ˆï¼Œæ–°åŠ å…¥çš„å…ƒç´ æ¯”æ ˆé¡¶å…ƒç´ å°(å¤§)ã€‚

æ¨¡æ¿ï¼ˆå•è°ƒä¸å¢æ ˆï¼‰ï¼š

```java
public int monotonicStack(int[] height) {
    if (height.length <= 2) return 0;
    Stack<Integer> stack = new Stack<>();
    int ans = 0;
    stack.push(0);
    int i = 1;
    while (i < height.length) {
        while (!stack.empty() && height[i] > height[stack.peek()]) {
            Integer pop = stack.pop();
            if (!stack.empty()) {
                // å¤„ç†é€»è¾‘
                int h = Math.min(height[i], height[stack.peek()]) - height[pop];
                ans += h * (i - stack.peek() - 1);
            }
        }
        stack.push(i++);
    }
    return ans;
}
```

### 3. æ»‘åŠ¨çª—å£

ä¾‹é¢˜ï¼š

* [æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/)

æ»‘åŠ¨çª—å£å¯ä»¥ç”¨æ¥è§£å†³åºåˆ—æˆ–è€…æ•°ç»„ä¸­çš„å¾ªç¯é—®é¢˜ï¼Œå¯ä»¥å°†åµŒå¥—å¾ªç¯é—®é¢˜è½¬æ¢ä¸ºå•å¾ªç¯é—®é¢˜ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚æ»‘åŠ¨çª—å£ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œåªæ¶‰åŠåˆ°æ•°æ®æŸæ®µåºåˆ—çš„å¤´å’Œå°¾æ“ä½œã€‚

## ä¸‰. æ ‘å’Œæ£®æ—

### 1. æ ‘çŠ¶æ•°ç»„å’Œçº¿æ®µæ ‘

é¢˜ç›®ï¼š

* [1264. åŠ¨æ€æ±‚è¿ç»­åŒºé—´å’Œ (æ¨¡æ¿)](https://www.acwing.com/problem/content/1266/)

åº”ç”¨äºå•ç‚¹ä¿®æ”¹å’ŒåŒºé—´æŸ¥è¯¢ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(\log n)$

ğŸ”µæ ‘çŠ¶æ•°ç»„

* $O(\log n)$å¿«é€Ÿæ±‚å‰ç¼€å’Œã€‚
* åœ¨æŸä¸ªä½ç½®çš„æ•°ï¼ŒåŠ ä¸Šä¸€ä¸ªæ•°

![image-20220223162823400](ç®—æ³•å¿ƒæ³•.assets/image-20220223162823400.png)

æ ‘çŠ¶æ•°ç»„çš„å±‚æ•°æ˜¯æœ‰å¯¹åº”ä½ç½®æ•°å­—äºŒè¿›åˆ¶æœ«å°¾å‡ ä¸ªé›¶å†³å®šã€‚

æ ‘çŠ¶æ•°ç»„æœ‰ä¸‰ä¸ªå¿…è¦æ“ä½œï¼š`lowbit(x), add(), query()`ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰¹å®šè®¡ç®—ï¼Œå¯¹æŸä¸ªå…ƒç´ æ·»åŠ ä¸€ä¸ªå€¼ä»¥åŠæŸ¥è¯¢å‰ç¼€å’Œã€‚å…¶ä¸­$\text{lowbit(x)}=x\&-x$ã€‚å…¶æŸ¥è¯¢å‰ç¼€å’Œä»¥åŠè¿›å»åŒºé—´ä¿®æ”¹çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(\log n)$

æ±‚ä½ç½®ç´¢å¼•`x`ä¹‹å‰åºåˆ—å‰ç¼€å’Œï¼š

```c
for(int i=x;i>0;i-=lowbit(i))res+=c[i];
```

åœ¨ä½ç½®ç´¢å¼•`x`æ·»åŠ æ•°å€¼`v`åéœ€è¦è¿›è¡Œçš„åºåˆ—ä¿®æ”¹ï¼š

```c
for(int i = x; i <= n; i += lowbit(x))c[i]+=v;
```

æ¨¡æ¿ï¼š

```c++
#include "iostream"
#include "cstdio"
#include "algorithm"

using namespace std;

typedef long long ll;

const int N = 100010;
int n, m;
int tr[N];

int lowbit(int x) {
    return x & -x;
}

void add(int t, int x) {
    for (int i = t; i <= n; i += lowbit(i)) tr[i] += x;
}

ll query(int t) {
    ll ans = 0;
    for (int i = t; i > 0; i -= lowbit(i)) {
        ans += tr[i];
    }
    return ans;
}

int main() {
    cin >> n >> m;
    for (int i = 1; i <= n; ++i) {
        int item;
        scanf("%d", &item);
        add(i, item);
    }
    int k, a, b;
    while (m--) {
        scanf("%d%d%d", &k, &a, &b);
        if (k) add(a, b);
        else cout << query(b) - query(a - 1) << endl;
    }
}
```

ğŸ”µçº¿æ®µæ ‘

![img](ç®—æ³•å¿ƒæ³•.assets/çº¿æ®µæ ‘è¡¨ç¤º.png)

å…¶ç»´æŒçš„å°±æ˜¯ç»“æ„ä½“æ•°ç»„ï¼Œç»“æ„ä½“ä¸­è®°å½•æ•°ç»„çš„è¾¹ç•Œå’Œæ‰€ä¿å­˜çš„å€¼ã€‚

åŸºç¡€çº¿æ®µæ ‘æœ‰å››ä¸ªæ“ä½œï¼š`pushup()`æ ¹æ®å­èŠ‚ç‚¹çš„ä¿¡æ¯æ¥æ›´æ–°çˆ¶èŠ‚ç‚¹ï¼Œ`build()`æ„é€ çº¿æ®µæ ‘ï¼Œ`modify()`å•ç‚¹ä¿®æ”¹ï¼Œ`query()`åŒºé—´æŸ¥è¯¢ã€‚

æ¨¡æ¿ï¼š

```c++
#include "cstdio"

const int N = 100010;
int arr[N];
struct Node {
    int l, r;
    int sum;
} tr[N * 4 + 1];
int n, m;

void pushup(int u) {
    tr[u].sum = tr[u << 1].sum + tr[u << 1 | 1].sum;
}

void build(int u, int l, int r) {
    if (l == r) tr[u] = {l, r, arr[l]};
    else {
        tr[u] = {l, r};
        int mid = l + r >> 1;
        build(u << 1, l, mid), build(u << 1 | 1, mid + 1, r);
        pushup(u);
    }
}

void modify(int u, int t, int x) {
    if (tr[u].l == tr[u].r)tr[u].sum += x;
    else {
        int mid = tr[u].l + tr[u].r >> 1;
        if (t <= mid) modify(u << 1, t, x);
        else modify(u << 1 | 1, t, x);
        pushup(u);
    }
}

int query(int u, int l, int r) {
    if (tr[u].l >= l && tr[u].r <= r)return tr[u].sum;
    int mid = tr[u].l + tr[u].r >> 1;
    int sum = 0;
    if (l <= mid) sum = query(u << 1, l, r);
    if (r > mid) sum += query(u << 1 | 1, l, r);
    return sum;
}

int main() {
    scanf("%d%d", &n, &m);
    for (int i = 1; i <= n; ++i) scanf("%d", &arr[i]);
    build(1, 1, n);
    int k, a, b;
    for (int i = 0; i < m; ++i) {
        scanf("%d%d%d", &k, &a, &b);
        if (k) modify(1, a, b);
        else printf("%d\n", query(1, a, b));
    }
}
```

### 2. æ ‘çš„ç›´å¾„(wait)

ä¾‹é¢˜ï¼š[1207. å¤§è‡£çš„æ—…è´¹](https://www.acwing.com/problem/content/1209/)

## å››. å›¾è®º



## äº”. é€’å½’åˆ†æ²»

### 1. äºŒåˆ†æ€æƒ³

é¢˜ç›®ï¼š

* [789. æ•°çš„èŒƒå›´ (æ¨¡æ¿é¢˜)](https://www.acwing.com/problem/content/791/)

æ€æƒ³ï¼š

1. ç¡®å®šä¸€ä¸ªåŒºé—´ï¼Œä½¿å¾—ç­”æ¡ˆä¸€å®šåœ¨åŒºé—´å†…ã€‚
2. æ‰¾ä¸€ä¸ªæ€§è´¨æ»¡è¶³ä¸¤ç‚¹ï¼š
   * æ€§è´¨å…·æœ‰äºŒæ®µæ€§ï¼Œå‰æ®µæ»¡è¶³æ¡ä»¶ï¼Œåæ®µä¸æ»¡è¶³æ¡ä»¶
   * ç­”æ¡ˆæ˜¯å…·æœ‰åˆ†ç•Œç‚¹çš„

æ¯”å¦‚æ•´æ•°äºŒåˆ†ã€‚

æ‰¾åŒºé—´å·¦ç«¯ç‚¹æ—¶ï¼š$\text{mid}=\dfrac{l+r}{2}$ï¼Œæ‰¾åŒºé—´å³ç«¯ç‚¹çš„æ—¶å€™ï¼š$\text{mid}=\dfrac{l+r+1}{2}$

å› ä¸ºå¯¹äºå¥‡æ•°é™¤ä»¥2çš„æ—¶å€™é»˜è®¤å‘ä¸‹å–æ•´ã€‚å› æ­¤æ‰¾å·¦ç«¯ç‚¹çš„æ—¶å€™é»˜è®¤ç«¯ç‚¹é å·¦ï¼Œæ‰¾å³ç«¯ç‚¹çš„æ—¶å€™è®¡ç®—midæ—¶å€™éœ€è¦åŠ ä¸€ï¼Œè®©å³ç«¯ç‚¹çš„èŒƒå›´æ›´åŠ é å³ã€‚

```c
#include<cstdio>
#include<cstring>

int n, q;

int s[100010];

int main(){
	scanf("%d%d", &n, &q);
	for(int i=0;i<n;i++)scanf("%d", &s[i]);
	for(int i = 0; i < q; i ++){
		int t;
		scanf("%d", &t);
		
		int l = 0, r = n - 1;
		while(l < r){		// æ‰¾å·¦ç«¯ç‚¹
			int mid = l + r >> 1;
			if(s[mid] >= t) r = mid;
			else l = mid + 1;
		}
		
		if(s[r] == t){
			printf("%d ", r);
			r = n - 1;
			while(l < r){	// æ‰¾å³ç«¯ç‚¹
				int mid = l + r + 1 >> 1; // l = mid +1å‘ä¸Šå–æ•´
				if(s[mid] <= t) l = mid;
				else r = mid - 1;
			}
			printf("%d\n", r);
		}else{
			printf("-1 -1\n");
		}
	} 
	return 0;
}
```

### 2. å…¨æ’åˆ—

```c
void permutation(int *a, int low, int high){
    if(low==high){
        for (int i = 0; i <= high; ++i) printf("%d ",a[i]);
        printf("\n");
    }else{
        for (int i = low; i <= high; ++i) {
            swap(&a[low],&a[i]);
            permutation(a,low +1, high);
            swap(&a[low],&a[i]);	//å†æ¢å›æ¥
        }
    }
}
```

### 3. ä¸‹ä¸€ä¸ªå­—å…¸åº

ä¾‹é¢˜ï¼š[31. ä¸‹ä¸€ä¸ªæ’åˆ—](https://leetcode-cn.com/problems/next-permutation/)

æ­¥éª¤ä¸€ï¼šç”±æ’åˆ—è®¡ç®—å‡ºå­—å…¸åºå€¼ï¼š

è®¾ç»™å®šçš„$\{1,2,...,n\}$çš„æ’åˆ—ä¸º $\pi$ ï¼Œè®¾å…¶å­—å…¸åºçš„å€¼ä¸º $\text{rank}(\pi,n)$ï¼Œé‚£ä¹ˆå…¶å¯¹åº”çš„å­—å…¸åºå€¼æ˜¾ç„¶å­˜åœ¨ï¼š
$$
(\pi[1]-1)\cdot(n-1)!\le \text{rank}(\pi,n)\le \pi[1]\cdot(n-1)!-1
$$
è®¾ $r$ ä¸º $\pi$ åœ¨ä»¥$\pi[1]$ å¼€å¤´çš„æ‰€æœ‰æ’åˆ—ä¸­çš„åºå·ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ° $r$ ä¹Ÿæ˜¯é›†åˆ $\{1,2,...,n\}-\{\pi[1]\}$ ä¸­åºåˆ—ä¸º $[\pi[2],\pi[3]],...\pi[n]$ çš„åºå·ã€‚é‚£ä¹ˆå°† $\pi$ ä¸­æ‰€æœ‰å¤§äº $\pi[1]$ çš„å…ƒç´ éƒ½å‡ä¸€å°±ä¼šå¾—åˆ°é›†åˆ$\{1,2,...,n-1\}$çš„æ’åˆ— $\pi'$ï¼Œå…¶å­—å…¸åºä¹Ÿæ˜¯ $r$ ï¼Œç”±æ­¤å°±å¾—åˆ°è®¡ç®—$\text{rank}(\pi,n)$çš„é€’å½’å…¬å¼ï¼š
$$
\text{rank}(\pi,n)=(\pi[1]-1)\cdot(n-1)!+\text{rank}(\pi',n-1)
$$
å…¶ä¸­$\pi'[i]=\begin{cases}\pi[i+1]-1,&\pi[i+1]>\pi[i]\\\pi[i+1],&\pi[i+1]<\pi[i]\end{cases}$

æ­¥éª¤äºŒï¼šç”±æ’åˆ—è®¡ç®—å‡ºä¸‹ä¸€ä¸ªæ’åˆ—ï¼š

ç”±ä¸€ä¸ªå­—å…¸åºæ‰¾åˆ°ä¸‹ä¸€ä¸ªå­—å…¸åºï¼Œæ¯”å¦‚åºåˆ— *26458173*ï¼Œé¦–å…ˆæ”¹å˜çš„æ•°å€¼ä¸€å®šæ˜¯ä»ä¸ªä½å¼€å§‹ã€‚ä¸æ”¹å˜ä¸ªä½ä»¥ä¸Šçš„å€¼èƒ½å¦å°†åºåˆ—å¢å¤§ï¼Ÿä¸èƒ½ï¼›ä¸æ”¹å˜åä½ä»¥ä¸Šçš„å€¼åªæ”¹å˜â€œ73â€èƒ½å¦å°†åºåˆ—çš„å€¼å¢å¤§ï¼Ÿä¸èƒ½ï¼›ä¸æ”¹å˜ç™¾ä½ä»¥ä¸Šçš„å€¼åªæ”¹å˜â€œ173â€èƒ½å¦å°†åºåˆ—çš„å€¼å¢å¤§ï¼Ÿå¯ä»¥ï¼Œå› ä¸ºå­˜åœ¨åºåˆ—â€œ317ï¼Œ371...â€ > "173"ã€‚è§‚å¯Ÿå¯ä»¥å¾—åˆ°ä»¥ä¸‹è§„å¾‹ï¼Œå³æ‰¾åˆ°ä¸‹æ ‡ä¸º $i$ çš„æ•°å­—æ»¡è¶³ $a[i]<a[i+1]$ï¼Œä¸”å¯¹äº $i+1$ ä¹‹åçš„åºåˆ—éƒ½æœ‰ $a[i+1]>a[i+2]>\cdots>a[n]$ã€‚æ‰¾åˆ°ä¸‹æ ‡ $i$ ä¹‹åå¦‚ä½•ä»â€œ317ï¼Œ371ï¼Œ713ï¼Œ731â€ä¸­æ‰¾åˆ°æœ€é€‚åˆçš„åºåˆ—ï¼Ÿæ˜¾ç„¶è¿™ä¸ªåºåˆ—æ˜¯â€œ317â€ã€‚å› æ­¤è¿˜åº”è¯¥æ‰¾åˆ°ä¸‹æ ‡ $j$ æ»¡è¶³ $a[j]$ åˆšå¥½å¤§äº $a[i]$å³ $a[j+1],a[j+2],...,a[n]<a[i],a[j]>a[i]$ï¼Œç„¶å $\text{swap}(a[i],a[j])$ï¼Œå°† $a[i+1:n]$ è¿›è¡Œé€†åºå¤„ç†å³å¯å¾—åˆ°ä¸‹ä¸€ä¸ªæ•°åˆ—ã€‚

ç¨‹åºå¦‚ä¸‹ï¼š

```c++
#include <bits/stdc++.h>
#define MAX 20+5
using namespace std;

int a[MAX],b[MAX],fac[MAX];

int dictIndex(int a[], int n){	//è®¡ç®—å­—å…¸åº
    int s = 0;
    for (int j = 0; j < n; ++j) {
        for(int i=j+1;i<n;i++)if(a[i]>a[j])a[i]--;	//å¯¹a[j+1:n]å¤§äºa[j]å…ƒç´ è¿›è¡Œ-1
        s+=(a[j]-1)*fac[n-j-1];		// åŠ æ¯å±‚çš„åºå· (Ï€[i]-1)*(n-i-1)!
    }
    return s;
}


int main(){
    int n;
    scanf("%d",&n);
    fac[0]=1;
    for(int i=0;i<n;i++){
        fac[i+1]=(i+1)*fac[i];
        scanf("%d",&b[i]);
        a[i]=b[i];
    }
    cout<<dictIndex(a,n)<<endl;	//å¾—åˆ°å­—å…¸åº
    int i=n-2;
    while(b[i]>b[i+1])i--;	//æ‰¾åˆ°å¯ä»¥å¢å¤§çš„åºå·
    int j=i+1;
    while(j+1<n&&b[j+1]>b[i])j++;
    swap(b[i],b[j]);		//æ‰¾åˆ°å¯ä»¥äº¤æ¢çš„åºå·
    i++,j=n-1;
    while(i<j)swap(b[i++],b[j--]);	//å¯¹a[i+1:n]è¿›è¡Œé€†åºå¤„ç†
    for (int k = 0; k < n; ++k) cout<<b[k]<<" ";//è¾“å‡º
    return 0;
}
```



## å…­. è´ªå¿ƒ

è´ªå¿ƒç®—æ³•å‡ºé¢˜å½¢å¼ä¸å®šï¼Œå¹¶ä¸”è¯æ˜è¾ƒéš¾ã€‚

## ä¸ƒ. åŠ¨æ€è§„åˆ’

### 1. èƒŒåŒ…é—®é¢˜

è§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1qt411Z7nE

ğŸ”µ01èƒŒåŒ…é—®é¢˜

> æ¯ä¸ªç‰©å“åªèƒ½é€‰æˆ–è€…ä¸é€‰ä¸¤ç§æƒ…å†µ

ä½¿ç”¨ $f[i][j]$ æ¥è¡¨ç¤ºè½®åˆ°é€‰æ‹©ç¬¬ $i$ ä¸ªç‰©å“çš„æ—¶å€™ä½“ç§¯ä¸º $j$ çš„ä»·å€¼ï¼Œåˆ™å¯ä»¥å¾—åˆ°dpæ–¹ç¨‹ï¼š
$$
f(i,j)=\begin{cases}f(i-1,j),&\text{discard}\\f(i-1,j-v[i])+w[i],&\text{selected}\end{cases}
$$
åˆæ¬¡å¾—åˆ°ï¼š

```c++
#include<iostream>
using namespace std;

const int N = 1010;
int w[N],v[n],dp[N][N];	//wä»·å€¼æ•°ç»„ï¼Œvä½“ç§¯æ•°ç»„ï¼Œdpæ•°ç»„

int main(){
    int n,m;	//ç‰©å“æ•°é‡ï¼Œæœ€å¤§å®¹ç§¯
    cin>>n>>m;
    for(int i=1;i<=n;i++)cin>>v[i]>>w[i];
    for(int i=1;i<n;i++){
        for(int j=0;j<=m;j++){
            dp[i][j]=dp[i-1][j];
            if(j>=v[i])
                dp[i][j]=max(dp[i][j],dp[i-1][j-v[i]]+w[i]);
        }
    }
    int res=0;
    for(int i=0;i<=m;i++)res = max(res,dp[n][m]);
    cout<<res<<endl;
    return 0;
}
```

ä¼˜åŒ–ç©ºé—´ï¼š

```c++
#include<iostream>
using namespace std;

const int N = 1010;
int w[N],v[N],dp[N];	//wä»·å€¼æ•°ç»„ï¼Œvä½“ç§¯æ•°ç»„ï¼Œdpæ•°ç»„

int main(){
    int n,m;	//ç‰©å“æ•°é‡ï¼Œæœ€å¤§å®¹ç§¯
    cin>>n>>m;
    for(int i=1;i<=n;i++)cin>>v[i]>>w[i];
    for(int i=1;i<=n;i++)
        for(int j=m;j>=v[i];j--){
            dp[j]=max(dp[j],dp[j-v[i]]+w[i]);
    		//é‡‡ç”¨å€’åºå°±ä¸ä¼šå¯¼è‡´dp[i-1][j-v[i]]çš„å€¼æ”¹å˜
    		//å¦‚æœè¿™é‡Œçš„å€’åºæ”¹æˆæ­£åºï¼Œå¾ªç¯ä½“ä¸å˜ï¼Œé‚£å°±å¯¼è‡´äºŒç»´æ—¶å€™dp[i-1][j-v[i]]å‘ç”Ÿæ”¹å˜
             //é‚£å°±å˜æˆå®Œå…¨èƒŒåŒ…é—®é¢˜äº†
        }
    cout<<dp[m]<<endl;
    return 0;
}
```

ç»“æœçš„å€¼ä¸º01èƒŒåŒ…æœ€åçš„æœ€ä¼˜ç»“æœä¸ºèƒŒåŒ…ä½“ç§¯å°äºç­‰äºmçš„æƒ…å†µï¼Œå¦‚æœæƒ³è¦æ‰¾ä½“ç§¯æ°å¥½ä¸ºmçš„æƒ…å†µï¼Œéœ€è¦å°†$dp[0]=0$ä¹‹å¤–ï¼Œå…¶ä»–$dp[i]=-\infin$å³å¯ã€‚

ğŸ”µå®Œå…¨èƒŒåŒ…é—®é¢˜

>æ¯ä»¶ç‰©å“å¯ä»¥é€‰æ— é™æ¬¡

æ€è·¯ï¼šç”±äºæ¯ä¸ªç‰©å“éƒ½å¯ä»¥é€‰æ— æ•°æ¬¡ï¼Œé‚£å°±å°†åœ¨éå†æ¯ä¸ªç‰©å“çš„æ—¶å€™ä¸€ç›´é€‰ï¼Œç›´åˆ°é€‰æ»¡èƒŒåŒ…çš„ä½“ç§¯ä¸ºæ­¢ã€‚è®¾$dp[i],(i\le V)$ ä¸ºä½“ç§¯ï¼Œæ¯æ¬¡éå†ä¸€ä¸ªç‰©å“ï¼Œä¾æ¬¡æ›´æ–° $dp[i+k*v[i]]=dp[i]+k*w[i]$ï¼Œå…¶ä¸­ $k$ å€¼æ»¡è¶³ $0\le k\le M,\ i+M*v[i]\le V\le i+(M+1)*v[i]$

```c++
for(int i = 0; i < n; i++){	//ä¾æ¬¡é€‰å–ç‰©å“
    for(int j = m; j >= v[i]; j--){	//ä¾æ¬¡ä»æœ€å¤§å€¼å¼€å§‹å‡
        for(int k = 1; k * v[i] <= j; k++){	//ä¾æ¬¡é€‰å–kä¸ªç‰©å“i
            f[j] = max(f[j],f[j - k * v[i]] + k * w[i]);
        }
    }
}
```

ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ï¼š

```c++
#include<iostream>
using namespace std;
const int N = 1010;
int dp[N];

int main(){
    int n,m;
    cin>>n>>m;
    for(int i=0;i<n;i++){
        int v,w;
        cin>>v>>w;
        for(int j=v;j<=m;j++) //ä»ä½å¼€å§‹è®¡ç®—
            dp[j] = max(dp[j],dp[j-v]+w);	
        	//æ­¤æ—¶å°±åŒ…å«äº†å–(k-1)ä¸ªç‰©å“içš„æƒ…å†µï¼Œæ•°å­¦å½’çº³è¯æ˜
    }
    cout<<dp[m]<<endl;
    return 0;
}
```

ğŸ”µå¤šé‡èƒŒåŒ…é—®é¢˜

> æ¯ä¸ªç‰©å“é€‰æ‹©çš„ä¸Šé™æ¬¡æ•°ä¸åŒ

æœ‰äº†å‰é¢ä¸¤é“çš„åŸºç¡€ï¼Œè¿™é“é¢˜å°±ç®€å•äº†

æœªä¼˜åŒ–ï¼šO(n^3^)https://www.acwing.com/problem/content/4/

```c++
#include<iostream>
using namespace std;
const int N = 1010;
int dp[N];

int main(){
    int n,m;
    cin>>n>>m;
    for(int i=0;i<n;i++){
        int v,w,cnt;
        cin>>v>>w>>cnt;
        for(int j=m;j>=v;j--){
            for(int k=1;k<=cnt&&k*v<=j;k++)		//å°±æ˜¯å®Œå…¨èƒŒåŒ…çš„O(n^3)æ ·ä¾‹ï¼ŒåŠ ä¸ªcnté™åˆ¶å³å¯
                dp[j] = max(dp[j],dp[j-k*v]+k*w);
        }
    }
    cout<<dp[m]<<endl;
    return 0;
}
```

**äºŒè¿›åˆ¶ä¼˜åŒ–ï¼š**https://www.acwing.com/problem/content/5/

> æ€è€ƒå¦‚ä½•å°†æ··åˆèƒŒåŒ…é—®é¢˜è½¬åŒ–æˆ01èƒŒåŒ…é—®é¢˜

ç”±äºå¤šé‡èƒŒåŒ…é—®é¢˜é™åˆ¶äº†æ¯ä¸ªç‰©å“çš„æœ€å¤šæ‹¿å–çš„æ¬¡æ•°ï¼Œå› æ­¤ä¸å¦‚ä½¿ç”¨æ‹†åˆ†çš„æ€æƒ³å°†mä¸ªç›¸åŒçš„ç‰©å“ $i$ï¼Œå¥—ç”¨01èƒŒåŒ…O(n^2^)çš„è§£æ³•å®ç°æ—¶é—´å¤æ‚åº¦çš„å‡å°‘ã€‚

å‡å¦‚ä¸€ä¸ªç‰©å“ $i$ ä»·å€¼ä¸º $w$ æœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæ ¹æ®äºŒè¿›åˆ¶æ¥è®²10ä¸ªç”¨4ä¸ªäºŒè¿›åˆ¶æ•°æ¥è¿›è¡Œè¡¨ç¤ºï¼Œæœ€é«˜ä¸º1010ã€‚æ¯æ¬¡è¿›è¡Œåˆ†å‰²çš„æ—¶å€™å¯ä»¥åˆ†ä¸º1ï¼Œ2ï¼Œ4ï¼Œ8ä¸ªã€‚ç”±äº1+2+4+8=15è¶…è¿‡äº†10ï¼Œå› æ­¤æœ€åä¸€ä¸ª8å¯ä»¥ç”¨3æ¥æ›¿æ¢ã€‚é‚£ä¹ˆ10ä»¥å†…çš„æ•°å­—å°±å¯ä»¥ç”¨1ï¼Œ2ï¼Œ4ï¼Œ3è¡¨ç¤ºä¸ºï¼š

1 = 1

2 = 2	3 = 1 +2

4 = 4	5 = 1 + 4	6 = 2 + 4

7 = 1 + 2 + 4	8 = 1 + 4 + 3	9 = 2 + 4 + 3	10 = 1 + 2 + 4 + 3

è¿™æ ·æ¯ä¸ªæ•°å­—åªå‡ºç°äº†ä¸€éï¼Œä½†æ˜¯ç»è¿‡ç»„åˆä¹‹åä»å¯ä»¥å‡‘æ»¡ä» $0\sim10$æ‰€æœ‰çš„æ•°å­—ï¼Œå› æ­¤åœ¨å†…å±‚å¾ªç¯ä¸­çš„å¤æ‚åº¦å°±å‡ä¸ºäº† $O(\log_2 n)$ æ•°é‡çº§ï¼Œå¯¹äº$dp[i]$ æ¥è¯´ï¼Œå¦‚æœ $dp[i]$ å€¼æ›´æ–°ï¼Œé‚£ä¹ˆå°±é€‰å–æŸä¸ªåŸºæ•°ï¼Œå¦‚æœæœªæ›´æ–°å°±ä¸é€‰å–å³å¯ï¼Œæ€»ä¹‹æœ€å¤§å€¼ä¸º10ã€‚

```c++
#include <bits/stdc++.h>

using namespace std;
const int N = 2020;

int dp[N];

struct Good{
    int v,w;
};

int main(){
    int n,m;
    cin>>n>>m;
    vector<Good> goods;
    for(int i=0;i<n;i++){
        int v,w,s;
        cin>>v>>w>>s;
        for(int k=1;k<=s;k*=2){
            s-=k;
            goods.push_back({k*v,k*w});
        }
        if(s>0)goods.push_back({s*v,s*w});
    }
    for(auto good:goods)
        for(int i=m;i>=good.v;i--)
            dp[i] = max(dp[i],dp[i-good.v] + good.w);
    cout<<dp[m]<<endl;
}
```

## å…«. æ’åº

### 1. å¿«é€Ÿæ’åº

```c
void quicksort(int *a, int low, int high){
    if(low >= high)return;
    int x = a[(low + high) / 2], i = low - 1,j = high + 1;
    while(i<j){
        do i++; while(a[i]<x);	//ä¸xç›¸åŒçš„æƒ…å†µä¼šç›´æ¥ç•¥è¿‡
        do j--; while(a[j]>x);
        if(i<j)swap(a[i],a[j]);
    }
    quicksort(low, j);	//æœ€ç»ˆa[j]<x,a[i]>x,å› æ­¤åˆ†ç•Œç‚¹ä¸ºj
    quicksort(j+1, high);
}
```

### 2. æ¡¶æ’åº

> ä½¿ç”¨å‰æï¼šæ•°æ®å‡åŒ€åˆ†å¸ƒã€‚æ¡¶çš„æ•°é‡=$\sqrt n$

```c++
void bucketSort(int *a, int n){
    int bucketCounts = sqrt(n) + 1;
    vector<node*> buckets(bucketCounts,new node(0));
    for(int i=0;i<n;i++){
        node* head = buckets[a[i]/bucketCounts];
        head = insert(head,a[i]); //è¿™é‡Œæ˜¯æœ‰åºæ’å…¥
    }
    node* h;
    for(int i=0;i<n;i++)h=merge(buckets[i]);//æœ‰åºåˆå¹¶å„ä¸ªæ¡¶çš„é“¾è¡¨
    while(h!=NULL){//è¾“å‡º
        cout<<h->data<<" ";
        h = h->next;
    }
}
```

## ä¹. æ•°è®º

### 1. å¤§æ•°å–ä½™

é¢˜ç›®ï¼š[JJoffer-14](https://leetcode-cn.com/problems/jian-sheng-zi-ii-lcof/)

ğŸ”µå‰ç½®çŸ¥è¯†ï¼ˆä½™æ•°çš„æ€§è´¨ï¼‰ï¼š

* æ’ç­‰æ€§ï¼š$(a\mod n) \mod n = a\mod n$
* é€†è¿ç®—ï¼š$[(-a\mod n)+(a\mod n)]\mod n=0$
* åˆ†é…å¾‹ï¼š
  * $(a+b)\mod n=[(a\mod n)+(b\mod n)]\mod n$
  * $ab\mod n=[(a\mod n)(b\mod n)]\mod n$

ğŸ”µå¾ªç¯å–ä½™æ³•
$$
x^a \mod  p = [(x ^{a-1} \mod  p)(x \mod  p)] \mod  p=[(x ^{a-1} \mod  p)x] \mod  p
$$
ğŸ”µå¿«é€Ÿå¹‚æ±‚ä½™
$$
{x^a \mod  p = }
\begin{cases}
(x^2 \mod  p)^{a // 2} \mod  p &  \text{, $a$ ä¸ºå¶æ•°} \\
{[(x \mod  p)(x ^{a-1} \mod  p)] \mod  p = [x(x^2 \mod  p)^{a//2}] \mod  p} & \text{, $a$ ä¸ºå¥‡æ•°} \\
\end{cases}
$$

### 2. æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°

æœ€å¤§å…¬çº¦æ•°(greatest common division)å’Œæœ€å°å…¬å€æ•°(Least common multiple)çš„å…³ç³»ï¼š
$$
\text{lcm}(a,b)=\dfrac{a\cdot b}{\gcd(a,b)}
$$


æœ€å¤§å…¬çº¦æ•°ï¼š

```c++
int gcd(int a,int b){
    if(b)while((a%=b)&&(b%=a));
    return a+b;
}

int gcd(int a, int b){
    return b ? gcd(b, a % b) : a;
}
```

æœ€å°å…¬å€æ•°ï¼š

```c++
int lcm(int a,int b){
    return a*b/gcd(a,b);
}
```

### 3. å› å¼åˆ†è§£å®šç†

å¯¹äºä»»æ„æ•°$N$éƒ½æœ‰ï¼š
$$
N = P_1^{\alpha_1}\times P_2^{\alpha_2}\times ...\times P_k^{\alpha_k}
$$
å…¶ä¸­ $P$ ä¸ºè´¨æ•°ï¼Œ$\alpha$ ä¸ºæ­£æ•´æ•°

### 4. çº¿æ€§ç­›æ³•æ±‚ç´ æ•°

å¯ä»¥åœ¨ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å¾— $1\sim n$ ä¸­æ‰€æœ‰çš„è´¨æ•°ä»¥åŠæ¯ä¸ªæ•°çš„æœ€å°è´¨å› å­ã€‚

```c
#include "bits/stdc++.h"

using namespace std;

const int N = 1000010;
vector<int> primes;
bool st[N]; // true - åˆæ•°; false - è´¨æ•°
int min_factor[N];


void getPrimes(int n) {
    // get all the primes which lower equal than n.
    for (int i = 2; i <= n; ++i) {  // è™½ç„¶ç”±ä¸¤å±‚å¾ªç¯ä½†æ˜¯å…¶æ—¶é—´å¤æ‚åº¦ç¡®å®ä¸ºO(n)
        if (!st[i]) min_factor[i] = i, primes.push_back(i);
        for (int j = 0; i * primes[j] <= n; ++j) {
            st[i * primes[j]] = true;
            min_factor[i * primes[j]] = primes[j];  // è®°å½•æœ€å°è´¨å› å­
            // ä¹‹åä¸¤ä¸ªæ•°å­—ä¸äº’è´¨å°±è¡¨ç¤ºæ‰€å¾—ä¹˜ç§¯ä¸æ˜¯ç”±æœ€å°è´¨å› å­ä¹˜æ³•å¾—åˆ°
            // å› æ­¤éœ€è¦break
            if (i % primes[j] == 0) break;
        }
    }
}

int main() {
    getPrimes(20000);
    for (int i = 2; i < 100; ++i) {
        if(!st[i])cout<<i<< endl;
    }
}
```

æ€§è´¨ï¼š

1. è¢«ç­›é€‰æ‰çš„ä¸€å®šæ˜¯è´¨æ•°ï¼Œå¹¶ä¸”æ˜¯ç”±å…¶æœ€å°è´¨å› å­ç­›é€‰æ‰çš„ã€‚ï¼ˆå¯ä»¥æ ¹æ®è¿™ä¸ªæ€§è´¨å¾—åˆ°å…¶æœ€å°è´¨å› å­ï¼‰
2. æ‰€æœ‰çš„åˆæ•°ä¸€å®šä¼šè¢«ç­›æ‰ï¼å› ä¸ºåªæœ‰åœ¨ç¢°åˆ°å…¶æœ€å°è´¨å› å­å°±ä¼šç­›æ‰ï¼Œå› æ­¤ä¸ä¼šé—æ¼ã€‚

### 5. çº¦æ•°

ç”±äºå¯¹äºä»»æ„æ•°$N$éƒ½æœ‰ï¼š
$$
N = P_1^{\alpha_1}\times P_2^{\alpha_2}\times ...\times P_k^{\alpha_k}
$$
å…¶ä¸­ $P$ ä¸ºè´¨æ•°ï¼Œ$\alpha$ ä¸ºæ­£æ•´æ•°ã€‚

æ•°å­— $N$ çº¦æ•°æ€§è´¨æœ‰ï¼š

* çº¦æ•°ä¸ªæ•°å°±æ˜¯ $(\alpha_1+1)(\alpha_2+1)\cdots (\alpha_k+1)$ 
* æ‰€æœ‰çº¦æ•°ä¹‹å’Œæ˜¯ $\displaystyle \sum_{i=0}^{\alpha_1}P_1^i\cdot\sum_{i=0}^{\alpha_2}P_2^i\cdots\sum_{i=0}^{\alpha_k}P_k^i$



## å. æšä¸¾ä¸å“ˆå¸Œ

### 1. åŸåœ°å“ˆå¸Œ

å‚è€ƒï¼š[åŸåœ°å“ˆå¸Œ](https://blog.css8.cn/post/4942471.html)

é¢˜ç›®ï¼š

* [41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°](https://leetcode.cn/problems/first-missing-positive/)

å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ï¼Œæ‰€æœ‰æ•°çš„èŒƒå›´éƒ½åœ¨ $[0,n-1]$ å¹¶ä¸”éƒ½ä¸ç›¸åŒï¼Œä½¿ç”¨ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦è¿›è¡Œæ’åºã€‚

åŸåœ°å“ˆå¸Œçš„æ€æƒ³ï¼š

* å¦‚æœ $a[i] \neq i$ï¼Œé‚£ä¹ˆå°†æ•°å­—a[i]æ”¾ç½®åˆ°ç´¢å¼•ä¸ºa[i]çš„ä½ç½®ä¸Šï¼Œå³ $\text{swap}(a[i], a[a[i]])$ã€‚

![image-20220516200831557](ç®—æ³•å¿ƒæ³•.assets/image-20220516200831557.png)

ä»£ç ï¼š

```java
private void inplaceHash(int[] arr) {
    for (int i = 0; i < arr.length; i++) {
        while (arr[i] != i)
            swap(arr[i], arr[arr[i]]);
    }
}
```



## åä¸€. å­—ç¬¦ä¸²

### 1. manacher ç®—æ³•

å‚è€ƒï¼šhttps://www.bilibili.com/video/BV1L54y1D7pa

ä¾‹é¢˜ï¼š[5. æœ€é•¿å›æ–‡å­ä¸² - åŠ›æ‰£](https://leetcode-cn.com/problems/longest-palindromic-substring/)

å¯»æ‰¾å­—ç¬¦ä¸²ä¸­çš„æœ€é•¿å›æ–‡å­ä¸²(éå­åºåˆ—)çš„çº¿æ€§ç®—æ³•ã€‚

é¦–å…ˆæ˜¯å¯¹å­—ç¬¦ä¸²çš„é¢„å¤„ç†ï¼Œç”±äºå›æ–‡ä¸²çš„é•¿åº¦å¯èƒ½æ˜¯åŸºæ•°æˆ–è€…å¶æ•°ï¼Œå› æ­¤ç”±ä¸­å¿ƒå±•å¼€çš„æ—¶å€™ä¼šä¸æ–¹ä¾¿ï¼Œå› æ­¤éœ€è¦è¿›è¡Œå¡«å……ï¼Œæ¯”å¦‚ "aa" éœ€è¦å¡«å……ä¸º "#a#a#"ã€‚

manacherç®—æ³•ä¸­æœ‰å‡ ä¸ªé‡è¦çš„æ¦‚å¿µå®šä¹‰ï¼š

1. maxRightï¼Œå³åŸºäºä¸­å¿ƒç‚¹æ‰€èƒ½å»¶ç”³æœ€é•¿å›æ–‡ä¸²çš„å³è¾¹ç•Œä¸‹æ ‡ã€‚
2. mirrorï¼Œå³å½“å¾ªç¯éå† i < maxRight çš„æ—¶å€™åœ¨è¿™ä¸ªå›æ–‡ä¸²ä¸­çš„å¯¹ç§°ä¸‹æ ‡ã€‚

ä½¿ç”¨ p[] æ•°ç»„æ¥è®°å½•å½“å‰ä¸­å¿ƒç‚¹å‘å³æ‰€èƒ½å»¶ç”³çš„æœ€å¤§é•¿åº¦ï¼Œå…¶æ•°å€¼ä¹Ÿæ˜¯ä»¥å½“å‰ä¸ºä¸­å¿ƒç‚¹å›æ–‡ä¸²çš„é•¿åº¦ã€‚

å½“ i â‰¥ maxRight çš„æ—¶å€™ï¼Œè€è€å®å®è¿›è¡Œä¸­å¿ƒæ‰©æ•£ï¼›

å½“ i < maxRight çš„æ—¶å€™ï¼Œå¯ä»¥æ ¹æ®å¯¹ç§°çš„æ€æƒ³æ¥è¿›è¡Œç®€åŒ–è®¡ç®—ã€‚

![image-20220420154311747](ç®—æ³•å¿ƒæ³•.assets/image-20220420154311747.png)

å› æ­¤å½“ i < maxRight çš„æ—¶å€™ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æ¸…ç©ºï¼š

1. å½“ p[mirror] < maxRight - i æ—¶ï¼Œä»¥ä¸¤è€…ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²éƒ½è¢«ä¸»å›æ–‡ä¸²åŒ…è£¹ï¼Œp[i] = p[mirror]
2. å½“ p[mirror] = maxRight - i æ—¶ï¼Œp[i] çš„é•¿åº¦è‡³å°‘æ˜¯ p[mirror] ç„¶åè¿›è¡Œä¸­å¿ƒæ‰©æ•£ï¼Œæ‰©æ•£å®Œä¹‹åæ›´æ–°maxRight å’Œ center
3. å½“ p[mirror] > maxRight - i æ—¶ï¼Œp[i] = maxRight - i

### 2. KMP ç®—æ³•

å»ºè®®ä½¿ç”¨Sundayç®—æ³•ã€‚

```c++
void get_next(string T,int next[]){
    int i = 0, j = -1;
    next[0] = -1;
    while (i<T.length()){
        if(j==-1||T[i]==T[j])next[++i]=++j;//æ ¹æ®å‰åç¼€æ›´æ–°nextæ•°ç»„
        else j=next[j];
    }
}

int kmp(string s,string t){
    int i=0,j=0;
    int *next=new int[t.length()];
    memset(next,0,4*t.length());
    get_next(t,next);
    while(i<s.length()&&j<int(t.length())){
        if(j==-1||s[i]==t[j]){
            i++,j++;
        }else j=next[j];	//æ‰¾åˆ°ä¸Šä¸€ä¸ªå‰ç¼€
    }
    if(j>=t.length())return i-t.length();
    return -1;
}
```

### 3. Sunday ç®—æ³•

å‚è€ƒï¼š[å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•åŸç†è®²è§£(Hashã€KMPã€BMã€Sunday) ](https://juejin.cn/post/6844904176036610062#heading-10)

Sunday ç®—æ³•ç†è§£èµ·æ¥è¦æ¯” KMP å’Œ BM ç®—æ³•è¦æ›´å®¹æ˜“ã€‚Sunday åŒ¹é…ç®—æ³•æ˜¯ä»å·¦å¾€å³åŒ¹é…ï¼Œåœ¨åŒ¹é…å¤±è´¥çš„æ—¶å€™å…³æ³¨ä¸»ä¸²ä¸­å‚ä¸åŒ¹é…çš„æœ€æœ«ä½çš„ä¸‹ä¸€ä½å­—ç¬¦ï¼Œè§„åˆ™ä¸ºï¼š

* å¦‚æœè¯¥å­—ç¬¦æœªåœ¨å­ä¸²ä¸­å‡ºç°ï¼Œåˆ™å­ä¸²å³ç§»çš„é•¿åº¦ä¸ºå­ä¸²é•¿åº¦+1
* å¦‚æœå­—ç¬¦åœ¨å­ä¸²ä¸­å‡ºç°ï¼Œåˆ™å°†ä¸»ä¸²ä¸­è¯¥å­—ç¬¦ä¸å­ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°è¯¥å­—ç¬¦çš„ä½ç½®è¿›è¡Œå¯¹é½

Sunday ç®—æ³•éœ€è¦æ„å»ºä¸€ä¸ªåç§»è¡¨ï¼Œå­˜å‚¨æ¯ä¸ªå­—ç¬¦çš„åç§»é‡ã€‚

è®¾æ–‡æœ¬ä¸²Sä¸º"ATTAAGGCACATAC"ï¼Œæ¨¡å¼ä¸²Pä¸º"ACAT"ï¼Œæ¨¡å¼ä¸²ä¸­å­—ç¬¦çš„åç§»é‡ä¸º:

```
shift[A] = 4 - max(Açš„ä½ç½®) = 4 - 2 = 2

shift[C] = 4 - max(Cçš„ä½ç½®) = 4 - 1 = 3

shift[T] = 4 - max(tçš„ä½ç½®) = 4 - 3 = 1

shift[å…¶ä»–] = 4 + 1 = 5
```

![img](ç®—æ³•å¿ƒæ³•.assets/1726a31f4e5f3307tplv-t2oaga2asx-zoom-in-crop-mark1304000.awebp)

![img](ç®—æ³•å¿ƒæ³•.assets/1726a35225a930cbtplv-t2oaga2asx-zoom-in-crop-mark1304000.awebp)

![img](ç®—æ³•å¿ƒæ³•.assets/1726a372e25b40f0tplv-t2oaga2asx-zoom-in-crop-mark1304000.awebp)

![img](ç®—æ³•å¿ƒæ³•.assets/1726a3ac01b0afb6tplv-t2oaga2asx-zoom-in-crop-mark1304000.awebp)

ç®—æ³•å®ç°ï¼š

```java
private int[] shift = new int[512];
public int strStr(String a, String b) {
    int alen = a.length(), blen = b.length();
    Arrays.fill(shift, blen + 1);
    for (int i = 0; i < b.length(); i++) {
        shift[b.charAt(i)] = blen - i;
    }

    int m = 0, n;
    while (m <= alen - blen) {
        n = 0;
        while (a.charAt(m + n) == b.charAt(n)) {
            n++;
            if (n >= blen) return m;
        }
        if (m + blen >= alen) return -1;
        m += shift[a.charAt(m + blen)];
    }
    return -1;
}
```

## ç•ªå¤–ï¼šè¯­è¨€æŠ€å·§

### Java è¾“å…¥è¾“å‡º

å‚è€ƒï¼š[Javaä¸­System.out.printlnæ•ˆç‡è¾ƒä½](https://www.acwing.com/problem/content/discussion/content/7/)

å¯¹äºéœ€è¦Javaä¸­é¢‘ç¹è¿›è¡Œè¾“å…¥è¾“å‡ºï¼Œprintlnæ•ˆç‡è¾ƒä½ï¼Œéœ€è¦ä½¿ç”¨`BufferedWriter`ä»¥åŠ`BufferedReader`

> è®°å¾—å…³é—­æµ`close`å’Œåˆ·æ–°`flush()`ã€‚

æ•°æ®è¾“å…¥ï¼š

```java
public class P1227 {
    private static BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
    private static int N, K;
    private static int s[][];

    public static void main(String[] args) throws IOException {
        String[] strs = reader.readLine().split(" ");
        N = Integer.parseInt(strs[0]);
        K = Integer.parseInt(strs[1]);
        s = new int[N][2];
        for (int i = 0; i < N; i++) {
            String[] strs2 = reader.readLine().split(" ");
            s[i][0] = Integer.parseInt(strs2[0]);
            s[i][1] = Integer.parseInt(strs2[1]);
        }
        reader.close();
    }
}
```

æ•°æ®è¾“å‡ºï¼š

```java
public static void main(String[] args) throws IOException {
    BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));

    bw.write(min_cnt + "\n");
    
    // ,,,,

    bw.flush();
    bw.close();
}
```

